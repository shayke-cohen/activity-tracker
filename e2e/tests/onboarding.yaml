# Onboarding E2E Test
# Tests initial app launch and permission requests

name: App Onboarding
description: Test first launch experience and permission handling
platform: ios
app: com.activitytracker.ActivityTracker

config:
  autoAcceptAlerts: true  # Auto-accept HealthKit permissions
  timeout: 30000

steps:
  # Fresh app launch
  - name: Launch app fresh
    inspect:
      label: fresh-launch

  # Handle HealthKit permission (auto-accepted via config)
  - name: Wait for permission handling
    wait:
      for: duration
      duration: 2000

  # Verify main dashboard loads
  - name: Verify dashboard displayed
    assert:
      type: visible
      text: "Activity Tracker"

  - name: Verify Today's Progress section
    assert:
      type: visible
      text: "TODAY'S PROGRESS"

  # Verify all tabs are accessible
  - name: Check Home tab
    assert:
      type: visible
      text: "Home"

  - name: Check Awards tab exists
    assert:
      type: visible
      text: "Awards"

  - name: Check History tab exists
    assert:
      type: visible
      text: "History"

  - name: Check Profile tab exists
    assert:
      type: visible
      text: "Profile"

  # Verify core functionality
  - name: Verify step tracking active
    assert:
      type: visible
      text: "Steps"

  - name: Verify quick start section
    assert:
      type: visible
      text: "QUICK START"

  # Take baseline screenshot
  - name: Save onboarding complete baseline
    inspect:
      saveBaseline: "onboarding-complete"

  # Navigate through all tabs
  - name: Navigate to Awards
    act:
      action: tap
      text: "Awards"
    wait:
      for: element
      text: "Achievements"

  - name: Navigate to History
    act:
      action: tap
      text: "History"
    wait:
      for: element
      text: "History"

  - name: Navigate to Profile
    act:
      action: tap
      text: "Profile"
    wait:
      for: element
      text: "Settings"

  - name: Return to Home
    act:
      action: tap
      text: "Home"
    wait:
      for: element
      text: "Activity Tracker"

  - name: Onboarding flow complete
    inspect:
      label: onboarding-complete
